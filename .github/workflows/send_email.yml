name: Notify on Push to Main Branch

on:
  push:
    branches:
      - main

jobs:
  send-email:
    runs-on: ubuntu-latest

    steps:
      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '14'

      - name: Install ssmtp
        run: |
          sudo apt update
          sudo apt install -y ssmtp

      - name: Send Email Notification
        env:
          TO_EMAIL: ${{ secrets.NOTIFICATION_EMAIL }}
          GITHUB_ACTOR: ${{ github.actor }}
          GITHUB_REPOSITORY: ${{ github.repository }}
          GITHUB_REF: ${{ github.ref }}
          GITHUB_SHA: ${{ github.sha }}
        run: |
          echo "Subject: Push event on $GITHUB_REPOSITORY" > mail.txt
          echo "From: GitHub Actions <actions@github.com>" >> mail.txt
          echo "To: $TO_EMAIL" >> mail.txt
          echo "" >> mail.txt
          echo "Push event occurred on the main branch of $GITHUB_REPOSITORY." >> mail.txt
          cat mail.txt | ssmtp $TO_EMAIL
